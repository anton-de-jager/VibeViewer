"use strict";(self.webpackChunkvibeViewer=self.webpackChunkvibeViewer||[]).push([[628],{2628:(rt,Z,a)=>{a.r(Z),a.d(Z,{PromotionModule:()=>et});var p=a(2510),g=a(4859),h=a(7392),A=a(5524),b=a(5861),f=a(7423),w=a(3951),_=a(2340),c=a(6090),m=a(5938),P=a(908),t=a(4650),C=a(6895),I=a(430);function J(n,s){if(1&n&&(t.TgZ(0,"div",21),t._uU(1),t.qZA()),2&n){const o=t.oxw(2);t.xp6(1),t.Oqu(o.name)}}function N(n,s){1&n&&(t.TgZ(0,"div",21),t._uU(1,"System Message"),t.qZA())}const T=function(){return["./"]};function S(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"a",22),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(2);return t.KtG(i.viewLocation(i.lat,i.lon))}),t._uU(1),t.qZA()}if(2&n){const o=t.oxw().$implicit,e=t.oxw();t.Q6J("color","primary")("routerLink",t.DdM(4,T))("disabled",e.loading),t.xp6(1),t.hij(" ",o("location")," ")}}function U(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"a",23),t.NdJ("click",function(i){t.CHM(o);const r=t.oxw(2);return t.KtG(r.viewReviews(i,r.images))}),t._uU(1),t.qZA()}if(2&n){const o=t.oxw().$implicit,e=t.oxw();t.Q6J("color","primary")("routerLink",t.DdM(4,T))("disabled",e.loading||0==e.images.length),t.xp6(1),t.hij(" ",o("reviews")," ")}}function D(n,s){if(1&n&&(t.TgZ(0,"a",24),t._uU(1," Play Store "),t.qZA()),2&n){const o=t.oxw(2);t.Q6J("color","primary")("disabled",o.loading)}}function M(n,s){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"h1",1)(2,"div",2),t.YNc(3,J,2,1,"div",3),t.YNc(4,N,2,0,"div",3),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.cancel())}),t._UZ(7,"mat-icon",6),t.qZA()()()(),t.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),t._uU(12),t.qZA(),t.TgZ(13,"div",11),t._UZ(14,"img",12),t.qZA(),t._UZ(15,"p",13),t.qZA(),t._UZ(16,"hr"),t.TgZ(17,"div",14),t.YNc(18,S,2,5,"a",15),t.YNc(19,U,2,5,"a",16),t.YNc(20,D,2,2,"a",17),t.qZA()()(),t.TgZ(21,"div",18),t._UZ(22,"span",19),t.TgZ(23,"button",20),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.submit())}),t._uU(24),t.qZA()(),t.BQk()}if(2&n){const o=s.$implicit,e=t.oxw();t.xp6(3),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"!=e.userId),t.xp6(1),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"==e.userId),t.xp6(3),t.Q6J("svgIcon","mat_outline:close"),t.xp6(5),t.Oqu(e.title),t.xp6(2),t.Q6J("src",e.api+"/Images/Promotions/"+e.id+"."+e.urlImage,t.LSH),t.xp6(1),t.Q6J("innerHTML",e.content,t.oJD),t.xp6(3),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"!=e.userId),t.xp6(1),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"!=e.userId),t.xp6(1),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"==e.userId),t.xp6(4),t.Oqu(o("done"))}}const L={enableHighAccuracy:!0,timeout:25e3,maximumAge:0};let Y=(()=>{class n{constructor(o,e,i){this.dialogRef=o,this.dialog=e,this.data=i,this.name="",this.title="",this.content="",this.urlImage="",this.api=_.N.api,this.id="",this.userId=i.userId,this.name=i.name,this.title=i.title,this.content=i.content,this.urlImage=i.urlImage,this.id=i.id,this.images=i.images,this.lat=i.lat,this.lon=i.lon}ngOnInit(){}viewLocation(o,e){return(0,b.Z)(function*(){"web"!==f.dV.getPlatform()&&"granted"!==(yield c.b.checkPermissions()).location&&"granted"!==(yield c.b.requestPermissions()).location||c.b.getCurrentPosition(L).then(i=>{w.A.open({url:"https://www.google.com/maps/dir/"+i.coords.latitude+","+i.coords.longitude+"/"+o+","+e+"/data=!3m1!4b1!4m2!4m1!3e0"})})})()}viewReviews(o,e){if(0==e.length)o.preventDefault();else{const i=new m.vA;i.data={item:this.images,list:this.images},i.autoFocus=!0,i.disableClose=!0,i.hasBackdrop=!0,i.ariaLabel="fffff",i.width="100vw",i.maxWidth="800px",i.panelClass="full-screen-modal",this.dialog.open(P.Z,i).afterClosed().subscribe(l=>{})}}sortByDtateString(o){return o.sort((e,i)=>Number(i.substring(i.indexOf("_")+1).split("_")[0])-Number(e.substring(e.indexOf("_")+1).split("_")[0]))}submit(){this.dialogRef.close(null)}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(m.so),t.Y36(m.uw),t.Y36(m.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-promotion-view"]],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title","",1,"accent","dialog-title","bg-primary","text-on-primary","text-secondary",2,"margin-bottom","0px !important"],[1,"flex","items-center","justify-between"],["class","text-2xl font-semibold leading-tight",4,"ngIf"],[1,"-mr-3"],["mat-icon-button","",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-dialog-content","",1,"content-dialog"],[1,"relative","flex","flex-col","flex-auto","min-w-0","m-12","overflow-hidden"],["fxLayout","","fxLayoutAlign","center center mb-4",2,"text-align","center"],[1,"text-4xl","font-extrabold","tracking-tight","leading-tight","mb-4",2,"margin","0 auto"],[1,"image-box"],[1,"image-picker",3,"src"],[1,"mt-4",2,"text-align","center",3,"innerHTML"],["fxLayout","","fxLayoutAlign","center center mt-4",2,"text-align","center"],["mat-flat-button","","style","border-radius:12px!important","class","px-3 mr-1","mat-button","",3,"color","routerLink","disabled","click",4,"ngIf"],["mat-flat-button","","style","border-radius:12px!important","class","px-3","mat-button","",3,"color","routerLink","disabled","click",4,"ngIf"],["mat-flat-button","","style","border-radius:12px!important","class","px-3","mat-button","","href","https://play.google.com/store/apps/details?id=com.vibeviewer.app","target","_blank",3,"color","disabled",4,"ngIf"],["mat-dialog-actions","","align","end",1,"dialog-footer",2,"margin-top","0!important"],[2,"flex","1 1 auto"],["mat-raised-button","","color","primary",3,"click"],[1,"text-2xl","font-semibold","leading-tight"],["mat-flat-button","","mat-button","",1,"px-3","mr-1",2,"border-radius","12px!important",3,"color","routerLink","disabled","click"],["mat-flat-button","","mat-button","",1,"px-3",2,"border-radius","12px!important",3,"color","routerLink","disabled","click"],["mat-flat-button","","mat-button","","href","https://play.google.com/store/apps/details?id=com.vibeviewer.app","target","_blank",1,"px-3",2,"border-radius","12px!important",3,"color","disabled"]],template:function(o,e){1&o&&t.YNc(0,M,25,10,"ng-container",0)},dependencies:[C.O5,g.lW,g.zs,h.Hw,I.KI],styles:[".image[_ngcontent-%COMP%]{position:relative;width:100%;height:70vh;border-radius:12px;object-fit:cover}.content-dialog[_ngcontent-%COMP%]{padding-top:12px}"]}),n})();var H=a(5838),Q=a(1299),F=a(7495),V=a(5830),O=a(6362),K=a(4909),B=a(9602),E=a(2494);function $(n,s){1&n&&(t.TgZ(0,"fuse-alert",13)(1,"span",14),t._uU(2,"No Promotions"),t.qZA(),t._uU(3," There are currently no promotions near you "),t.qZA()),2&n&&t.Q6J("type","primary")}function q(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"div",20),t.NdJ("click",function(){t.CHM(o);const i=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.openPromotion(i))}),t._uU(1),t.qZA()}if(2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.name)}}function G(n,s){1&n&&t._UZ(0,"br")}const y=function(){return["./"]};function j(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"div",34)(1,"a",35),t.NdJ("click",function(){t.CHM(o);const i=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.viewLocation(i.lat,i.lon))}),t._uU(2),t.qZA(),t.TgZ(3,"a",36),t.NdJ("click",function(i){t.CHM(o);const r=t.oxw().$implicit,l=t.oxw(3);return t.KtG(l.viewReviews(i,r))}),t._uU(4),t.qZA()()}if(2&n){const o=t.oxw().$implicit,e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.Q6J("color","primary")("routerLink",t.DdM(8,y))("disabled",i.loading),t.xp6(1),t.hij(" ",e("location")," "),t.xp6(1),t.Q6J("color","primary")("routerLink",t.DdM(9,y))("disabled",i.loading||0==o.reviewCount),t.xp6(1),t.hij(" ",e("reviews")," ")}}function R(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"fuse-card",17)(1,"div",18),t.YNc(2,q,2,1,"div",19),t.TgZ(3,"div",20),t.NdJ("click",function(){const r=t.CHM(o).$implicit,l=t.oxw(3);return t.KtG(l.openPromotion(r))}),t._uU(4),t.qZA(),t._UZ(5,"div",21),t.TgZ(6,"div",22),t.NdJ("click",function(){const r=t.CHM(o).$implicit,l=t.oxw(3);return t.KtG(l.openPromotion(r))}),t.TgZ(7,"div",23)(8,"span")(9,"a",24),t._uU(10),t.qZA()(),t.TgZ(11,"span",25),t._uU(12,"\u2022"),t.qZA(),t.TgZ(13,"span",26),t._uU(14),t.qZA()()(),t.YNc(15,G,1,0,"br",27),t.YNc(16,j,5,10,"div",28),t.qZA(),t.TgZ(17,"div",29),t.NdJ("click",function(){const r=t.CHM(o).$implicit,l=t.oxw(3);return t.KtG(l.openPromotion(r))}),t.TgZ(18,"div",30)(19,"div",31)(20,"div",32)(21,"div",33),t._uU(22," \xa0 "),t.qZA()()()()()()}if(2&n){const o=s.$implicit,e=t.oxw(3);t.xp6(2),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"!=o.userId),t.xp6(2),t.Oqu(o.title),t.xp6(1),t.Q6J("innerHTML",o.content,t.oJD),t.xp6(5),t.Oqu(o.web),t.xp6(4),t.Oqu(o.phone),t.xp6(1),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"==o.userId),t.xp6(1),t.Q6J("ngIf","00000000-0000-0000-0000-000000000000"!=o.userId),t.xp6(5),t.Udp("background-image","url("+e.api+"/Images/Promotions/"+o.id+"."+o.urlImage+")")}}function z(n,s){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,R,23,9,"fuse-card",16),t.qZA()),2&n){const o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o.list)}}function W(n,s){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2),t.ynx(3),t.TgZ(4,"div",3),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.goHome())}),t._UZ(5,"img",4),t.qZA(),t.TgZ(6,"div",5),t._uU(7,"Promotions"),t.qZA(),t.BQk(),t.TgZ(8,"div",6),t._UZ(9,"user"),t.qZA()(),t.YNc(10,$,4,1,"fuse-alert",7),t.YNc(11,z,2,1,"div",8),t._UZ(12,"div",9),t.qZA(),t.TgZ(13,"div",10)(14,"button",11),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.goHome())}),t._UZ(15,"mat-icon",12),t._uU(16),t.qZA()(),t.BQk()}if(2&n){const o=s.$implicit,e=t.oxw();t.xp6(10),t.Q6J("ngIf",!e.list||0==e.list.length),t.xp6(1),t.Q6J("ngIf",e.list&&e.list.length>0),t.xp6(5),t.hij("\xa0\xa0",o("home")," ")}}const k={enableHighAccuracy:!0,timeout:25e3,maximumAge:0},X=[{path:"",component:(()=>{class n{constructor(o,e,i,r,l,x,u,it){this.variableService=o,this._userService=e,this._router=i,this.dialog=r,this.route=l,this.apiService=x,this._changeDetectorRef=u,this.fuseSplashScreenService=it,this.content="",this.title="",this.urlImage="",this.api=_.N.api,this.id="",this.list=[],this.fuseSplashScreenService.show(),this.id=this._router.url.split("/").pop(),this.getPromotions().then(nt=>{this.list=nt,"all"!==this.id?this.apiService.getItemParm("promotions",this.id).subscribe(d=>{d?(this.title=d.title,this.content=d.content,this.urlImage=d.urlImage,this.apiService.getItemParm("users",d.userId).subscribe(v=>{this.fuseSplashScreenService.hide(),this.openPromotion({userId:d.userId,name:v.name,title:this.title,content:this.content,urlImage:this.urlImage,id:this.id,reviewImages:v.reviewImages,lat:v.lat,lon:v.lon}),setTimeout(()=>{u.detectChanges(),u.markForCheck()},200)})):this.fuseSplashScreenService.hide()}):this.fuseSplashScreenService.hide()})}selectPromotion(o){}openPromotion(o){const e=new m.vA;e.data={userId:o.userId,name:o.name,lat:o.lat,lon:o.lon,title:o.title,content:o.content,urlImage:o.urlImage,id:o.id,images:o.reviewImages?this.sortByDtateString(o.reviewImages.split(",")).map(r=>_.N.api+"/Images/Reviews/"+r.trim()):[]},e.autoFocus=!0,e.disableClose=!0,e.hasBackdrop=!0,e.ariaLabel="fffff",e.width="100vw",e.maxWidth="800px",e.panelClass="full-screen-modal",this.dialog.open(Y,e).afterClosed().subscribe(r=>{})}get currentYear(){return(new Date).getFullYear()}getPromotions(){var o=this,e=new Promise(function(){var i=(0,b.Z)(function*(r){try{"web"!==f.dV.getPlatform()&&"granted"!==(yield c.b.checkPermissions()).location&&"granted"!==(yield c.b.requestPermissions()).location&&r([]),c.b.getCurrentPosition(k).then(l=>{H.A.getId().then(x=>{o.apiService.getDevicePromotionsAll(x.uuid,l.coords.latitude,l.coords.longitude).subscribe(u=>{r(u)})})})}catch{r([])}});return function(r){return i.apply(this,arguments)}}());return e}viewLocation(o,e){return(0,b.Z)(function*(){"web"!==f.dV.getPlatform()&&"granted"!==(yield c.b.checkPermissions()).location&&"granted"!==(yield c.b.requestPermissions()).location||c.b.getCurrentPosition(k).then(i=>{w.A.open({url:"https://www.google.com/maps/dir/"+i.coords.latitude+","+i.coords.longitude+"/"+o+","+e+"/data=!3m1!4b1!4m2!4m1!3e0"})})})()}viewReviews(o,e){if(0==e.reviewCount)o.preventDefault();else{const i=new m.vA;e.images=this.sortByDtateString(e.reviewImages.split(",")).map(l=>_.N.api+"/Images/Reviews/"+l.trim()),i.data={item:e,list:this.sortByDtateString(e.images)},i.autoFocus=!0,i.disableClose=!0,i.hasBackdrop=!0,i.ariaLabel="fffff",i.width="100vw",i.maxWidth="800px",i.panelClass="full-screen-modal",this.dialog.open(P.Z,i).afterClosed().subscribe(l=>{})}}sortByDtateString(o){return o.sort((e,i)=>Number(i.substring(i.indexOf("_")+1).split("_")[0])-Number(e.substring(e.indexOf("_")+1).split("_")[0]))}goHome(){this._router.navigate(["home"])}navigateExternal(o,e){o.preventDefault(),f.dV.isNativePlatform?w.A.open({url:e}):window.open(e,"_blank")}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(Q.S),t.Y36(F.K),t.Y36(p.F0),t.Y36(m.uw),t.Y36(p.gz),t.Y36(V.s),t.Y36(t.sBO),t.Y36(O.j))},n.\u0275cmp=t.Xpm({type:n,selectors:[["promotion"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"flex","flex-col","flex-auto","w-full","min-w-0","custom-background"],[1,"relative","flex","flex-0","items-center","w-full","h-16","px-4","z-49","shadow","shadow-none","border-b","bg-card","bg-transparent","dark-background","print:hidden"],[1,"flex","items-center","mx-2","lg:mr-8",2,"cursor","pointer",3,"click"],["src","assets/images/logo/logo-text-on-dark.png",1,"flex","w-16"],[1,"text-2xl",2,"color","#FFF"],[1,"flex","items-center","pl-2","ml-auto","space-x-0.5","sm:space-x-2"],["class","m-4",3,"type",4,"ngIf"],["class","flex flex-wrap items-start w-full","style","margin-top: 64px;margin-bottom: 56px;",4,"ngIf"],[1,"relative","flex","flex-0","items-center","w-full","h-14","sm:h-20","px-4","md:px-6","z-49","border-t","bg-card","bg-transparent","print:hidden","custom-footer",2,"height","56px!important"],[1,"bottom-bar"],["mat-flat-button","","color","primary",3,"click"],["svgIcon","heroicons_outline:home"],[1,"m-4",3,"type"],["fuseAlertTitle",""],[1,"flex","flex-wrap","items-start","w-full",2,"margin-top","64px","margin-bottom","56px"],["class","flex flex-col sm:flex-row justify-between w-full filter-listing mb-4 fuse-card-light home-card",4,"ngFor","ngForOf"],[1,"flex","flex-col","sm:flex-row","justify-between","w-full","filter-listing","mb-4","fuse-card-light","home-card"],[1,"flex","flex-col","flex-auto","order-2","sm:order-1","mt-2","pl-4","pr-4"],["class","text-2xl font-semibold leading-tight",3,"click",4,"ngIf"],[1,"text-2xl","font-semibold","leading-tight",3,"click"],[1,"text-secondary","mt-2",3,"innerHTML"],[1,"mt-2",3,"click"],[1,"flex","flex-wrap","items-center","text-secondary","my-1"],["href","https://vibeviewer.com","target","_blank"],[1,"mx-2"],[1,"whitespace-nowrap"],[4,"ngIf"],["class","flex items-center mt-3 -mx-3","style","padding-bottom: 5px;",4,"ngIf"],[1,"order-1","sm:order-2","w-full","sm:w-100","rounded-lg","overflow-hidden",3,"click"],[1,"single-image-container-promotion-1"],[1,"single-image-container-promotion-2"],[1,"single-image-container-promotion-3"],[1,"single-image-promotion"],[1,"flex","items-center","mt-3","-mx-3",2,"padding-bottom","5px"],["mat-flat-button","","mat-button","",1,"px-3","mr-1","w-100-p",2,"width","100%","border-radius","12px!important",3,"color","routerLink","disabled","click"],["mat-flat-button","","mat-button","",1,"px-3",2,"width","100%","border-radius","12px!important",3,"color","routerLink","disabled","click"]],template:function(o,e){1&o&&t.YNc(0,W,17,3,"ng-container",0)},dependencies:[p.yS,g.lW,g.zs,h.Hw,K.A,C.sg,C.O5,B.y,E.W,I.KI],encapsulation:2}),n})()}];var tt=a(960),ot=a(6879);let et=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(X),g.ot,h.Ps,tt.PU,ot.z,A.m]}),n})()}}]);