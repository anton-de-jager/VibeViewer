"use strict";(self.webpackChunkvibeViewer=self.webpackChunkvibeViewer||[]).push([[797],{4660:(qe,U,a)=>{a.r(U),a.d(U,{ProfileModule:()=>Ye});var u=a(2510),j=a(7579),O=a(2722),e=a(4650),Q=a(3071),M=a(4880),y=a(7420),Y=a(6362),N=a(1299),T=a(6429),d=a(6895),C=a(4859),S=a(7392),w=a(3267),I=a(430),q=a(5861),B=a(529),s=a(4006),k=a(5938),F=a(6388),L=a(1050),$=a(2340),A=a(2958),p=a(7489),P=a(7495),R=a(5830),g=a(9549),E=a(4144),K=a(4385),D=a(3238);function G(o,r){if(1&o&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&o){const t=r.$implicit,i=e.oxw(2).$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",i(t.description),"")}}function H(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit;e.xp6(1),e.hij(" ",t("establishment_name_required")," ")}}function V(o,r){if(1&o&&(e.TgZ(0,"div",5)(1,"mat-form-field",6)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"mat-icon",7)(5,"input",20),e.YNc(6,H,2,1,"mat-error",14),e.qZA()()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Oqu(t("463af20d-e093-4ca0-9ac1-23909de39f9c"===i.accountForm.value.userTypeId?"name":"establishment_name")),e.xp6(1),e.Q6J("svgIcon","mat_outline:label"),e.xp6(1),e.Q6J("formControlName","name"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("name").hasError("required"))}}function z(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(4).$implicit;e.xp6(1),e.hij(" ",t("description_required")," ")}}function W(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",6)(1,"mat-label"),e._uU(2),e.qZA(),e._UZ(3,"textarea",23),e.YNc(4,z,2,1,"mat-error",14),e.qZA()),2&o){const t=e.oxw(3).$implicit,i=e.oxw();e.xp6(2),e.Oqu(t("description")),e.xp6(1),e.Q6J("formControlName","description"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("description").hasError("required"))}}function X(o,r){if(1&o&&(e.TgZ(0,"div",21),e.YNc(1,W,5,3,"mat-form-field",22),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==t.accountForm.value.userTypeId)}}function ee(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(4).$implicit;e.xp6(1),e.hij("",t("address_required")," ")}}function te(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-form-field",6)(1,"mat-label"),e._uU(2),e.qZA(),e._UZ(3,"mat-icon",7)(4,"input",24),e.TgZ(5,"button",25),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.getAddress())}),e.TgZ(6,"mat-icon"),e._uU(7,"search"),e.qZA()(),e.YNc(8,ee,2,1,"mat-error",14),e.qZA()}if(2&o){const t=e.oxw(3).$implicit,i=e.oxw();e.xp6(2),e.Oqu(t("address")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:location-marker"),e.xp6(1),e.s9C("placeholder",t("address")),e.xp6(4),e.Q6J("ngIf",i.accountForm.get("address").hasError("required"))}}function oe(o,r){if(1&o&&(e.TgZ(0,"div",5),e.YNc(1,te,9,4,"mat-form-field",22),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==t.accountForm.value.userTypeId)}}function ie(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t("email_required")," ")}}function ne(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t("email_validation")," ")}}function re(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit;e.xp6(1),e.hij(" ",t("phone_required")," ")}}function ae(o,r){if(1&o&&(e.TgZ(0,"div",5)(1,"mat-form-field",6)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"mat-icon",7)(5,"input",26),e.YNc(6,re,2,1,"mat-error",14),e.qZA()()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Oqu(t("phone")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:phone"),e.xp6(1),e.Q6J("formControlName","phone"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("phone").hasError("required"))}}function se(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3).$implicit;e.xp6(1),e.hij(" ",t("website_required")," ")}}function ce(o,r){if(1&o&&(e.TgZ(0,"div",5)(1,"mat-form-field",6)(2,"mat-label"),e._uU(3),e.qZA(),e._UZ(4,"mat-icon",27)(5,"input",26),e.YNc(6,se,2,1,"mat-error",14),e.qZA()()),2&o){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Oqu(t("www")),e.xp6(2),e.Q6J("formControlName","web"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("web").hasError("required"))}}function le(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t("paypal_email_validation")," ")}}function me(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"img",33),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.captureImage())}),e.qZA()}if(2&o){const t=e.oxw(4);e.Q6J("src",t.previewImage,e.LSH)}}function ue(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"img",33),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.captureImage())}),e.qZA()}if(2&o){const t=e.oxw(4);e.Q6J("src",t.imagesFolder+"Users/"+t.accountForm.value.id+t.accountForm.value.urlImage+"?t="+t.variableService.timestamp,e.LSH)}}function de(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"img",34),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.captureImage())}),e.qZA()}}function pe(o,r){if(1&o&&(e.TgZ(0,"div",28)(1,"div",29)(2,"div",30),e.YNc(3,me,1,1,"img",31),e.YNc(4,ue,1,1,"img",31),e.YNc(5,de,1,0,"img",32),e.qZA()()()),2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.previewImage),e.xp6(1),e.Q6J("ngIf",!t.previewImage&&t.accountForm.value.urlImage),e.xp6(1),e.Q6J("ngIf",!t.previewImage&&!t.accountForm.value.urlImage)}}function ge(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"form",3)(1,"div",4)(2,"div",5)(3,"mat-form-field",6)(4,"mat-label"),e._uU(5),e.qZA(),e._UZ(6,"mat-icon",7),e.TgZ(7,"mat-select",8,9),e.NdJ("selectionChange",function(n){e.CHM(t);const c=e.oxw(2);return e.KtG(c.venueTypeChanged(n))}),e.YNc(9,G,2,2,"mat-option",10),e.qZA(),e.TgZ(10,"mat-error"),e._uU(11),e.qZA()()(),e.YNc(12,V,7,4,"div",11),e.YNc(13,X,2,1,"div",12),e.YNc(14,oe,2,1,"div",11),e.TgZ(15,"div",5)(16,"mat-form-field",6)(17,"mat-label"),e._uU(18),e.qZA(),e._UZ(19,"mat-icon",7)(20,"input",13),e.YNc(21,ie,2,1,"mat-error",14),e.YNc(22,ne,2,1,"mat-error",14),e.qZA()(),e.YNc(23,ae,7,4,"div",11),e.YNc(24,ce,7,3,"div",11),e.TgZ(25,"div",5)(26,"mat-form-field",6)(27,"mat-label"),e._uU(28),e.qZA(),e._UZ(29,"mat-icon",7)(30,"input",15),e.YNc(31,le,2,1,"mat-error",14),e.qZA()(),e.YNc(32,pe,6,3,"div",16),e.qZA(),e.TgZ(33,"div",17)(34,"button",18),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.cancel())}),e._uU(35),e.qZA(),e.TgZ(36,"button",18),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.save())}),e._uU(37),e.qZA()()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("formGroup",i.accountForm),e.xp6(5),e.Oqu(t("establishment_type")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:office-building"),e.xp6(1),e.s9C("placeholder",t("establishment_type")),e.Q6J("formControlName","userTypeId"),e.xp6(2),e.Q6J("ngForOf",i.userTypeList),e.xp6(2),e.Oqu(t("establishment_type_required")),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(4),e.Oqu(t("email")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:mail"),e.xp6(1),e.Q6J("formControlName","email"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("email").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("email").hasError("email")),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(4),e.Oqu(t("paypal_email")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:mail"),e.xp6(1),e.Q6J("formControlName","paypalEmail"),e.xp6(1),e.Q6J("ngIf",i.accountForm.get("paypalEmail").hasError("paypalEmail")),e.xp6(1),e.Q6J("ngIf","463af20d-e093-4ca0-9ac1-23909de39f9c"!==i.accountForm.value.userTypeId&&""!==i.accountForm.value.userTypeId),e.xp6(2),e.Q6J("disabled",i.accountForm.disabled)("color","error"),e.xp6(1),e.hij("",t("cancel_subscription")," "),e.xp6(1),e.Q6J("disabled",i.accountForm.disabled)("color","primary"),e.xp6(1),e.hij("",t("submit")," ")}}function _e(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",1),e.YNc(2,ge,38,28,"form",2),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.accountForm)}}let fe=(()=>{class o{constructor(t,i,n,c,l,m,f,h,Z,b,J,v){this._changeDetectorRef=t,this._activatedRoute=i,this._userService=n,this._router=c,this._formBuilder=l,this.variableService=m,this.sharedService=f,this.apiService=h,this.fuseSplashScreenService=Z,this.dialog=b,this.router=J,this.eventEmitterService=v,this.alert={type:"success",message:""},this.showAlert=!1,this.previewImage=null,this.userTypeList=[],this.submitClicked=!1,this.imagesFolder=$.N.api+"/Images/",this.loading=!0,this.activated=!1,this.fuseSplashScreenService.show(),this.getUserTypes().then(Ne=>{this.userTypeList=Ne.sort((x,_)=>x.order>_.order?1:-1),this._userService.get().subscribe(x=>{this.user=x,this.userTypeList=(0,p.upperCase)(this.user.userTypeId)==(0,p.upperCase)("463af20d-e093-4ca0-9ac1-23909de39f9c")?this.userTypeList.filter(_=>(0,p.upperCase)(_.id)===(0,p.upperCase)("463af20d-e093-4ca0-9ac1-23909de39f9c")):this.userTypeList.filter(_=>(0,p.upperCase)(_.id)!==(0,p.upperCase)("463af20d-e093-4ca0-9ac1-23909de39f9c")),this.eventEmitterService.onChangeUser(x),this.user?(this.accountForm=this._formBuilder.group({id:[this.user.id,s.kI.required],userTypeId:[this.user.userTypeId,s.kI.required],name:[this.user.name,s.kI.required],description:[this.user.description],lat:[this.user.lat],lon:[this.user.lon],address:[this.user.address],email:[this.user.email,[s.kI.required,s.kI.email]],paypalEmail:[this.user.paypalEmail],phone:[this.user.phone],web:[this.user.web],urlImage:[this.user.urlImage],imageChanged:[!1]}),setTimeout(()=>{this._changeDetectorRef.markForCheck(),this.loading=!1,this.fuseSplashScreenService.hide()},200)):this.router.navigateByUrl("/sign-in")},x=>{localStorage.removeItem("AT"),localStorage.removeItem("RT"),localStorage.removeItem("ID");const _=this._activatedRoute.snapshot.queryParamMap.get("redirectURL")||"/home";this._router.navigateByUrl(_)})})}ngOnInit(){}getUserTypes(){return new Promise(i=>{try{this.apiService.getItem("userTypes").subscribe(n=>{i(n)})}catch{i([])}})}venueTypeChanged(t){(0,p.upperCase)(t.value)==(0,p.upperCase)("463af20d-e093-4ca0-9ac1-23909de39f9c")?(this.accountForm.get("name").clearValidators(),this.accountForm.get("description").clearValidators(),this.accountForm.get("address").clearValidators(),this.accountForm.get("address").clearValidators()):(this.accountForm.get("name").setValidators(s.kI.required),this.accountForm.get("description").setValidators(s.kI.required),this.accountForm.get("address").setValidators(s.kI.required),this.accountForm.get("address").setValidators(s.kI.required))}getAddress(){const t=new k.vA;t.data={label:"Enter Address",address:this.accountForm.controls.address.value,lat:this.accountForm.controls.lat.value,lon:this.accountForm.controls.lon.value},t.autoFocus=!0,t.disableClose=!0,t.hasBackdrop=!0,t.ariaLabel="fffff",t.width="100vw",t.maxWidth="800px",t.panelClass="full-screen-modal",this.dialog.open(L.S,t).afterClosed().subscribe(n=>{n&&(this.accountForm.controls.lat.setValue(n.location.lat),this.accountForm.controls.lon.setValue(n.location.lon),this.accountForm.controls.address.setValue(n.address),this._changeDetectorRef.markForCheck())})}activate(){this.activated=!0}save(){this.showAlert=!1,this.submitClicked=!0,!this.accountForm.invalid&&(this.accountForm.disable(),this.apiService.updateUser(this.accountForm.value).subscribe({next:t=>{console.log(this.fileToUpload),this.fileToUpload?(console.log("in"),this.uploadFile(this.fileToUpload,t.id+"."+this.fileToUpload.name.split(".").pop()).then(i=>{this.accountForm.enable(),t.urlImage="."+this.fileToUpload.name.split(".").pop(),this.alert={type:"success",message:"Profile Saved Successfully"},this.showAlert=!0,A.F.show({text:"Profile Saved Successfully"})})):(this.accountForm.enable(),this.alert={type:"success",message:"Profile Saved Successfully"},this.showAlert=!0,A.F.show({text:"Profile Saved Successfully"}))},error:t=>{this.accountForm.enable(),this.alert={type:"error",message:"Something went wrong, please try again."},this.showAlert=!0,A.F.show({text:"Something went wrong, please try again"})}}))}captureImage(){var t=this;return(0,q.Z)(function*(){F.V1.getPhoto({quality:100,allowEditing:!1,source:F.oK.Prompt,resultType:F.dk.Base64,height:1e3}).then(function(){var n=(0,q.Z)(function*(c){t.previewImage=`data:image/jpeg;base64,${c.base64String}`;const l=yield t.variableService.resizeImage({file:t.dataURLtoFile(`data:image/jpeg;base64,${c.base64String}`),maxSize:1e3});t.fileToUpload=t.dataURLtoFile(l),t.accountForm.controls.imageChanged.setValue(!0),t._changeDetectorRef.markForCheck()});return function(c){return n.apply(this,arguments)}}(),n=>{console.log(n)})})()}dataURLtoFile(t){for(var i=t.split(","),n=i[0].match(/:(.*?);/)[1],c=atob(i[1]),l=c.length,m=new Uint8Array(l);l--;)m[l]=c.charCodeAt(l);return new File([m],"file."+n.replace("image/",""),{type:n})}uploadFile(t,i){return new Promise(c=>{try{const l=new FormData;l.append("file",t),this.apiService.upload("users",l,i).subscribe(m=>{m.type===B.dt.Response&&c(!0)})}catch{c(!1)}})}cancel(){confirm("Are you sure you want to cancel subscription?")&&this.apiService.cancelSubscription(this.accountForm.controls.id.value).subscribe(t=>{alert("Subscription will be cancel after this period")})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(u.gz),e.Y36(P.K),e.Y36(u.F0),e.Y36(s.qu),e.Y36(N.S),e.Y36(y.F),e.Y36(R.s),e.Y36(Y.j),e.Y36(k.uw),e.Y36(u.F0),e.Y36(T.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["settings-account"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"w-full","mt-0"],["class","mat-white-bg w-100-p","fxLayout","column","fxLayoutAlign","start","fxFlex","1 0 auto","name","accountForm","novalidate","","style","padding: 0px!important;",3,"formGroup",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start","fxFlex","1 0 auto","name","accountForm","novalidate","",1,"mat-white-bg","w-100-p",2,"padding","0px!important",3,"formGroup"],[1,"grid","sm:grid-cols-4","gap-6","w-full","mt-8"],[1,"sm:col-span-2"],[1,"w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],[3,"placeholder","formControlName","selectionChange"],["establishment",""],[3,"value",4,"ngFor","ngForOf"],["class","sm:col-span-2",4,"ngIf"],["class","sm:col-span-4",4,"ngIf"],["readonly","","matInput","",3,"formControlName"],[4,"ngIf"],["id","paypalEmail","matInput","",3,"formControlName"],["class","sm:col-span-4 mb-4",4,"ngIf"],[1,"flex","items-center","justify-end"],["mat-flat-button","","type","button",1,"ml-4",3,"disabled","color","click"],[3,"value"],["id","name","matInput","",3,"formControlName"],[1,"sm:col-span-4"],["class","w-full",4,"ngIf"],["id","description","matInput","",3,"formControlName"],["readonly","","matInput","","formControlName","address","id","address",3,"placeholder"],["matSuffix","","mat-button","",3,"click"],["matInput","",3,"formControlName"],["svgIcon","mat_outline:computer","matPrefix","",1,"icon-size-5"],[1,"sm:col-span-4","mb-4"],["fxLayout","","fxLayoutAlign","center center",2,"margin-top","4px","margin-bottom","4px","cursor","pointer","text-align","center"],[1,"image-box"],["class","image-picker","onerror","this.src='assets/images/no-image.jpg';this.onerror='';",3,"src","click",4,"ngIf"],["class","image-placeholder","src","assets/images/add-image.png","onerror","this.src='assets/images/no-image.jpg';this.onerror='';",3,"click",4,"ngIf"],["onerror","this.src='assets/images/no-image.jpg';this.onerror='';",1,"image-picker",3,"src","click"],["src","assets/images/add-image.png","onerror","this.src='assets/images/no-image.jpg';this.onerror='';",1,"image-placeholder",3,"click"]],template:function(t,i){1&t&&e.YNc(0,_e,3,1,"ng-container",0)},dependencies:[d.sg,d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,C.lW,S.Hw,g.TO,g.KE,g.hX,g.qo,g.R9,E.Nt,K.gD,D.ey,I.KI],encapsulation:2}),o})();var he=a(2494);function ve(o,r){if(1&o&&(e.TgZ(0,"fuse-alert",13),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("appearance","outline")("showIcon",!1)("type",t.alert.type),e.xp6(1),e.hij(" ",t.alert.message," ")}}function xe(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1)(2,"form",2)(3,"div",1)(4,"div",3),e._uU(5),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),e._uU(10),e.qZA(),e._UZ(11,"mat-icon",7)(12,"input",8),e.qZA()(),e.TgZ(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),e._uU(16),e.qZA(),e._UZ(17,"mat-icon",7)(18,"input",8),e.qZA()()(),e._UZ(19,"div",9),e.TgZ(20,"div",10),e.YNc(21,ve,2,4,"fuse-alert",11),e.TgZ(22,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e._uU(23),e.qZA()()()(),e.BQk()}if(2&o){const t=r.$implicit,i=e.oxw();e.xp6(2),e.Q6J("formGroup",i.securityForm),e.xp6(3),e.Oqu(t("change_password")),e.xp6(5),e.Oqu(t("current_password")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:key"),e.xp6(1),e.Q6J("formControlName","passwordCurrent"),e.xp6(4),e.Oqu(t("new_password")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:key"),e.xp6(1),e.Q6J("formControlName","passwordNew"),e.xp6(3),e.Q6J("ngIf",i.showAlert),e.xp6(1),e.Q6J("disabled",!i.securityForm.valid)("color","primary"),e.xp6(1),e.hij("",t("submit")," ")}}let ye=(()=>{class o{constructor(t,i,n,c,l,m,f,h){this._changeDetectorRef=t,this._activatedRoute=i,this._userService=n,this._formBuilder=c,this.apiService=l,this.sharedService=m,this.router=f,this.eventEmitterService=h,this.alert={type:"success",message:""},this.showAlert=!1,this.activated=!1,this.securityForm=this._formBuilder.group({passwordCurrent:[""],passwordNew:[""]})}ngOnInit(){this._userService.get().subscribe(t=>{this.user=t,this.eventEmitterService.onChangeUser(t),this.user||this.router.navigateByUrl("/sign-in")},t=>{localStorage.removeItem("AT"),localStorage.removeItem("RT"),localStorage.removeItem("ID");const i=this._activatedRoute.snapshot.queryParamMap.get("redirectURL")||"/home";this.router.navigateByUrl(i)})}activate(){this.activated=!0}submit(){this.securityForm.disable(),this.showAlert=!1,this.apiService.changePassword({id:this.user.id,passwordCurrent:this.securityForm.value.passwordCurrent,passwordNew:this.securityForm.value.passwordNew}).subscribe({next:i=>{this.securityForm.enable(),this.alert={type:"success",message:"password Changed Successfully"},this.showAlert=!0,this._changeDetectorRef.markForCheck()},error:i=>{this.securityForm.enable(),this.alert={type:"error",message:i.error},this.showAlert=!0,this._changeDetectorRef.markForCheck()}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(u.gz),e.Y36(P.K),e.Y36(s.QS),e.Y36(R.s),e.Y36(y.F),e.Y36(u.F0),e.Y36(T.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["settings-security"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"w-full"],[3,"formGroup"],[1,"text-xl"],[1,"grid","sm:grid-cols-4","gap-6","w-full","mt-8"],[1,"sm:col-span-4"],[1,"fuse-mat-no-subscript","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["type","password","matInput","",3,"formControlName"],[1,"my-10","border-t"],[1,"flex","items-center","justify-end"],[3,"appearance","showIcon","type",4,"ngIf"],["mat-flat-button","","type","button",1,"ml-4",3,"disabled","color","click"],[3,"appearance","showIcon","type"]],template:function(t,i){1&t&&e.YNc(0,xe,24,12,"ng-container",0)},dependencies:[d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,C.lW,S.Hw,g.KE,g.hX,g.qo,E.Nt,he.W,I.KI],encapsulation:2,changeDetection:0}),o})();const Te=["drawer"],Ce=function(o,r){return{"hover:bg-gray-100 dark:hover:bg-hover":o,"bg-primary-50 dark:bg-hover":r}},Se=function(o,r){return{"text-hint":o,"text-primary dark:text-primary-500":r}},we=function(o){return{"text-primary dark:text-primary-500":o}};function Ie(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",21),e.NdJ("click",function(){const c=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.goToPanel(c.id))}),e._UZ(2,"mat-icon",22),e.TgZ(3,"div",23)(4,"div",24),e._uU(5),e.qZA(),e.TgZ(6,"div",25),e._uU(7),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit,i=e.oxw(2).$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(6,Ce,!n.selectedPanel||n.selectedPanel!==t.id,n.selectedPanel&&n.selectedPanel===t.id)),e.xp6(1),e.Q6J("ngClass",e.WLB(9,Se,!n.selectedPanel||n.selectedPanel!==t.id,n.selectedPanel&&n.selectedPanel===t.id))("svgIcon",t.icon),e.xp6(2),e.Q6J("ngClass",e.VKq(12,we,n.selectedPanel&&n.selectedPanel===t.id)),e.xp6(1),e.hij(" ",i(t.id)," "),e.xp6(2),e.hij(" ",i("panel_"+t.id+"_description")," ")}}function Fe(o,r){1&o&&(e.ynx(0),e._UZ(1,"settings-account"),e.BQk())}function Ae(o,r){1&o&&(e.ynx(0),e._UZ(1,"settings-security"),e.BQk())}function Ze(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",2)(1,"mat-drawer-container",3)(2,"mat-drawer",4,5)(4,"div",6)(5,"div",7),e._uU(6),e.qZA(),e.TgZ(7,"div",8)(8,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(3);return e.KtG(n.close())}),e._UZ(9,"mat-icon",10),e.qZA()()(),e.TgZ(10,"div",11),e.YNc(11,Ie,8,14,"ng-container",12),e.qZA()(),e.TgZ(12,"mat-drawer-content",13)(13,"div",14)(14,"div",15)(15,"button",16),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(3);return e.KtG(n.toggle())}),e._UZ(16,"mat-icon",10),e.qZA(),e.TgZ(17,"div",17),e._uU(18),e.qZA()(),e.TgZ(19,"div",18),e.ynx(20,19),e.YNc(21,Fe,2,0,"ng-container",20),e.YNc(22,Ae,2,0,"ng-container",20),e.BQk(),e.qZA()()()()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.xp6(2),e.Q6J("autoFocus",!1)("mode",i.drawerMode)("opened",i.drawerOpened),e.xp6(4),e.Oqu(t("settings")),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(2),e.Q6J("ngForOf",i.panels)("ngForTrackBy",i.trackByFn),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:menu"),e.xp6(2),e.hij(" ",t(i.getPanelInfo(i.selectedPanel).id)," "),e.xp6(2),e.Q6J("ngSwitch",i.selectedPanel),e.xp6(1),e.Q6J("ngSwitchCase","account"),e.xp6(1),e.Q6J("ngSwitchCase","security")}}function be(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Ze,23,12,"div",1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.user)}}let Je=(()=>{class o{constructor(t,i,n,c,l,m,f,h,Z,b,J){this._activatedRoute=t,this._userService=i,this._changeDetectorRef=n,this._router=c,this._fuseMediaWatcherService=l,this.sharedService=m,this.router=f,this.fuseSplashScreenService=h,this.variableService=Z,this.eventEmitterService=b,this.userService=J,this.drawerMode="side",this.drawerOpened=!0,this.panels=[],this.selectedPanel="account",this._unsubscribeAll=new j.x,this.fuseSplashScreenService.show(),this.userService.getUserInfo().subscribe({next:v=>{this.user=v,this.eventEmitterService.onChangeUser(this.user),this._changeDetectorRef.markForCheck(),this.user||(localStorage.removeItem("AT"),localStorage.removeItem("RT"),localStorage.removeItem("ID"),this.router.navigateByUrl("/sign-in")),this.eventEmitterService.onChangePage("profile")},error:()=>{localStorage.removeItem("AT"),localStorage.removeItem("RT"),localStorage.removeItem("ID");const v=this._activatedRoute.snapshot.queryParamMap.get("redirectURL")||"/home";this._router.navigateByUrl(v)}})}ngOnInit(){this.panels=[{id:"account",icon:"heroicons_outline:user-circle",title:"Account",description:"Manage your public profile and private information"},{id:"security",icon:"heroicons_outline:lock-closed",title:"Security",description:"Manage your password and 2-step verification preferences"}],this.fuseSplashScreenService.hide(),this._fuseMediaWatcherService.onMediaChange$.pipe((0,O.R)(this._unsubscribeAll)).subscribe(({matchingAliases:t})=>{t.includes("lg")?(this.drawerMode="side",this.drawerOpened=!0):(this.drawerMode="over",this.drawerOpened=!1),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}goToPanel(t){this.selectedPanel=t,"over"===this.drawerMode&&this.drawer.close()}getPanelInfo(t){return this.panels.find(i=>i.id===t)}trackByFn(t,i){return i.id||t}menuClicked(t){this._router.navigate([t])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.gz),e.Y36(Q.K),e.Y36(e.sBO),e.Y36(u.F0),e.Y36(M.T),e.Y36(y.F),e.Y36(u.F0),e.Y36(Y.j),e.Y36(N.S),e.Y36(T.Y),e.Y36(Q.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["profile"]],viewQuery:function(t,i){if(1&t&&e.Gf(Te,5),2&t){let n;e.iGM(n=e.CRH())&&(i.drawer=n.first)}},decls:1,vars:0,consts:[[4,"transloco"],["class","flex flex-col w-full min-w-0 sm:absolute sm:inset-0 sm:overflow-hidden",4,"ngIf"],[1,"flex","flex-col","w-full","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"flex-auto","sm:h-full","fuse-card-light"],[1,"sm:w-96","dark:bg-gray-900",3,"autoFocus","mode","opened"],["drawer",""],[1,"flex","items-center","justify-between","m-8","mr-6","sm:my-10"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"lg:hidden"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","divide-y","border-t","border-b"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-col"],[1,"flex-auto","px-6","pt-9","pb-12","md:p-8","md:pb-12","lg:p-12"],[1,"flex","items-center"],["mat-icon-button","",1,"lg:hidden","-ml-2",3,"click"],[1,"ml-2","lg:ml-0","text-3xl","font-bold","tracking-tight","leading-none"],[1,"mt-8"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","px-8","py-5","cursor-pointer",3,"ngClass","click"],[3,"ngClass","svgIcon"],[1,"ml-3"],[1,"font-medium","leading-6",3,"ngClass"],[1,"mt-0.5","text-secondary"]],template:function(t,i){1&t&&e.YNc(0,be,2,1,"ng-container",0)},dependencies:[d.mk,d.sg,d.O5,d.RF,d.n9,C.lW,S.Hw,w.jA,w.kh,w.LW,I.KI,fe,ye],encapsulation:2,changeDetection:0}),o})();var Ue=a(5524);const Qe=[{path:"",component:Je}];let Ye=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(Qe),Ue.m]}),o})()}}]);